customElements.define('format-input',class extends HTMLElement{constructor(){super()}connectedCallback(){let o=this;if(!o.stop)o.stop=!0;else return;if(o.children.length){o._init();return}o._observer=new MutationObserver(o._init.bind(o));o._observer.observe(o,{childList:!0})}handleEvent(e){this[`on${e.type}`](e)}onfocus(){let o=this;!o.view.validationMessage&&(o.view.type=o._type,o.view.value=o.input.value)}_setMessage(){let o=this;let b=o.dataset.showInvalid;b&&(o.querySelector(b).textContent=o.view.validationMessage)}formatterWait=1;onblur(){let o=this;if(document.activeElement==o.view)return;o.view.setCustomValidity('');o._setMessage();if(!o.view.checkValidity()){o._setMessage();return}if(!o.formatter)return;let a=o.formatter?.isValid(o.view.value);if(a){!o.inputListener&&(o.inputListener=!0,o.view.addEventListener('input',o));o.view.setCustomValidity(a);o._setMessage();return}o.input.value=o.view.value;o.view.type='text';o.view.value=o.formatter.format(this.input.value)}onkeydown(e){e.key=='Enter'&&(this.input.value=this.view.value)}oninput(){let o=this;if(!o.formatter)return;let A=o.formatter?.isValid(o.view.value);!A&&(o.view.setCustomValidity(''),o.view.removeEventListener('input',o),o._setMessage())}_init(){let o=this;o._observer?.disconnect();o._observer=null;let _=o.dataset.format;if(!_)return;let c=o.view=o.querySelector('input');if(!c)return;let d=o.input=c.cloneNode();c.addEventListener('focus',o);o._type=c.type;c.type='text';c.removeAttribute('name');d.type='hidden';o.appendChild(d);o.addFormatter(_)}addFormatter(B,C=1){let o=this;o.timeoutId=setTimeout(()=>{o.formatter=B?.split('.').reduce((acc,val)=>acc[val],window);!o.formatter?o.addFormatter(B,C*2):o.view.addEventListener('blur',o)},C)}disconnectedCallback(){this.timeoutId&&clearTimeout(this.timeoutId)}});
